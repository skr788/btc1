webpackJsonp([14],{1147:function(t,e,i){"use strict";var n,a,r,o,s,l,d,h;Object.defineProperty(e,"__esModule",{value:!0}),i.d(e,"PolygonPaneView",function(){return h}),n=i(5),i.n(n),a=i(14),i.n(a),r=i(33),o=i(21),s=i(92),l=i(115),d=i(1925),h=function(){function t(t,e){this._data=[],this._invalidated=!0,this._study=t,this._model=e}return t.prototype.update=function(){this._invalidated=!0},t.prototype.renderer=function(){var t,e,i,n,a;for(this._invalidated&&(this._updateViewInternal(),this._invalidated=!1),t=new s.CompositeRenderer,e=0,i=this._data;e<i.length;e++)n=i[e],a=new d.PolygonRenderer(new o.HitTestResult(o.HitTestResult.REGULAR)),a.setData(n),t.append(a);return t},t.prototype._updateViewInternal=function(){var t,e,i,o,s,d,h,u=this;this._data=[],t=this._study.priceScale(),e=this._model.timeScale(),!t||t.isEmpty()||e.isEmpty()||(i=this._study.graphics().polygons(),0!==i.size&&null!==(o=this._model.timeScale().visibleBars())&&null!=(s=this._study.firstValue())&&(d=o.firstBar(),h=o.lastBar(),i.forEach(function(i,o){var c,p,_,f,y=u._study.properties().graphics.polygons[o];if(100!==y.transparency.value())for(c=function(i){var o,c,p,_,f,v,g,w,x,T,m,b,R=i.indexes;for(o=0,c=i.items;o<c.length;o++){for(p=c[o],_=1/0,f=-1/0,v=!1,g=0,w=p.points;g<w.length;g++){if(x=w[g],(T=R[x.index])===r.REMOVE_INDEX_MAGIC_NUMBER){v=!0;break}m=T+(x.offset||0),_=Math.min(_,m),f=Math.max(f,m)}v||f<d||h<_||(b=p.points.map(function(i){var r=e.indexToCoordinate(R[i.index]+(i.offset||0)),o=t.priceToCoordinate(Object(n.ensureDefined)(i.level),s);return new a.Point(r,o)}),u._data.push({points:b,color:y.color.value(),backcolor:y.color.value(),linewidth:void 0!==y.showBorder&&y.showBorder.value()?1:0,linestyle:l.LINESTYLE_SOLID,filled:!0,fillBackground:!0,transparency:y.transparency.value(),mouseTouchable:y.mouseTouchable.value()}))}},p=0,_=i;p<_.length;p++)f=_[p],c(f)})))},t}()},1204:function(t,e,i){"use strict";function n(t,e){return t.y1-1>e?1:t.y2+1<e?-1:0}function a(t){var e,i,n,a,r=0;for(e=0,i=t;e<i.length;e++)n=i[e],a=n.rate.reduce(function(t,e){return t+e}),r=Math.max(r,a);return r}function r(t,e,i){if(i===f.a.LeftToRight)return t+e;if(i===f.a.RightToLeft)return e+t;throw Error("Unknown direction value: "+i)}function o(t,e,i){var n=l(t[0],e,i),a=l(t[t.length-1],e,i),r=Math.min(n.y1,n.y2,a.y1,a.y2);return(Math.max(n.y1,n.y2,a.y1,a.y2)-r)/t.length>5?1:0}function s(t,e,i,n,a,r,o,s){var d,h,u,c,p,_,y,v=a===f.b.Absolute,g=a===f.b.Relative,w=r===f.a.LeftToRight,x=r===f.a.RightToLeft;if(v&&w)d=i.indexToCoordinate(n[t.firstBarTime]),h=1,u="left";else if(v&&x)d=i.indexToCoordinate(n[t.lastBarTime]),h=-1,u="right";else if(g&&w)d=0,h=1,u="left";else{if(!g||!x)throw Error("Unknown location/direction values: "+a+"/"+r);d=i.width(),h=-1,u="right"}return c=l(t,e,s),p=c.y1,_=c.y2-o,y=.6*(_-p),{xBasePoint:d,sign:h,fontSize:y,textHAligh:u,y1:p,y2:_}}function l(t,e,i){var n=Object(h.ensure)(i.firstValue());return{y1:e.priceToCoordinate(t.priceHigh,n),y2:e.priceToCoordinate(t.priceLow,n)}}function d(t){var e,i,n=0
;for(e=0;e<t.length&&(null!==(i=t[e])&&void 0!==i);++e)n++;return n}var h,u,c,p,_,f,y,v,g,w,x,T;Object.defineProperty(e,"__esModule",{value:!0}),h=i(5),u=i(14),c=i(128),p=i(33),_=i(21),f=i(2116),y=i(92),v=i(410),g=i(157),w=function(){function t(t){this._data=null,this._data=t}return t.prototype.hitTest=function(t){var e,i,a,r,o,s,l,d,h,u=this._data;if(null===u)return null;if(e=Object.keys(u.histsBySession),0===e.length)return null;for(i=e.length-1;i>=0;i--){a=u.histsBySession[parseInt(e[i],10)],r=[];for(o in a)a.hasOwnProperty(o)&&r.push(a[o]);if(-1!==(s=Object(g.a)(r,t.y,n))&&(l=r[s],d=Math.min(l.x1,l.x2),h=Math.max(l.x1,l.x2),t.x>=d&&t.x<=h))return new _.HitTestResult(_.HitTestResult.REGULAR)}return null},t.prototype.draw=function(t){var e,i,n,a,r,o,s,l,d,h,u=this._data;if(null!==u){t.save();for(e in u.histsByLineWidth)if(u.histsByLineWidth.hasOwnProperty(e)){i=parseInt(e,10),n=u.histsByLineWidth[e],a=i%2==0?.5:0,r=Math.round(i/2);for(o in n)if(n.hasOwnProperty(o)){for(t.strokeStyle=o,t.lineWidth=i*(window.hidpiCanvasRatio||1),t.beginPath(),s=n[o],l=0,d=s;l<d.length;l++)h=d[l],t.moveTo(h.x1+.5,h.y1+r+a),t.lineTo(h.x2+.5,h.y1+r+a);t.stroke()}}t.restore()}},t}(),x=i(96),i.d(e,"HHistPaneView",function(){return T}),T=function(){function t(t,e){this._invalidated=!0,this._study=t,this._model=e,this._rendererData={histsByLineWidth:{},histsBySession:{}},this._textData=[],this._hhistRenderer=new w(this._rendererData)}return t.prototype.update=function(){this._invalidated=!0},t.prototype.renderer=function(){var t,e,i,n;for(this._invalidated&&(this._updateViewInternal(),this._invalidated=!1),t=new y.CompositeRenderer,t.append(this._hhistRenderer),e=0,i=this._textData;e<i.length;e++)n=i[e],t.append(new v.TextRenderer(n,new _.HitTestResult(_.HitTestResult.REGULAR)));return t},t.prototype._resetRenderersData=function(){this._rendererData.histsByLineWidth={},this._rendererData.histsBySession={},this._textData=[]},t.prototype._updateColors=function(){var t=this._study.properties().graphics.hhists.histBars,e=this._study.properties().graphics.hhists.vaBars,i=Object(x.generateColor)(t.colors[0].value(),t.transparencies[0].value()),n=Object(x.generateColor)(t.colors[1].value(),t.transparencies[1].value()),a=e?Object(x.generateColor)(e.colors[0].value(),e.transparencies[0].value()):"rgba(255, 0, 0, 1)",r=e&&e.colors[1]?Object(x.generateColor)(e.colors[1].value(),e.transparencies[1].value()):a;this._colors={histBars:[i,n],vaBars:[Object(x.blendColors)(i,a),Object(x.blendColors)(n,r)]}},t.prototype._updateViewInternal=function(){var t,e,i,n,r,o,s,l,d,u,c,p=this;this._resetRenderersData(),t=this._study.priceScale(),e=this._model.timeScale(),!t||t.isEmpty()||e.isEmpty()||null!=this._study.firstValue()&&(i=this._study.graphics().hhistsByTimePointIndex(),0!==i.size&&null!==(n=this._model.timeScale().visibleBars())&&(r=n.firstBar(),o=n.lastBar(),s="histBars",l=this._study.properties().graphics.hhists[s],l.visible.value()&&(this._updateColors(),d=this._study.graphics().hhistsByTimePointIndexShort().get(s),
u=this._study.graphics().hhistsByTimePointIndex().get(s),c=Object(h.ensureDefined)(d||u),c.forEach(function(i,n){var s,d,h,u=i.indexes,c=i.items,_=1/0,f=-1/0;for(s=c.length;s--;)d=c[s],_=Math.min(_,u[d.firstBarTime]),f=Math.max(f,u[d.lastBarTime]);f<r||_>o||(h=a(c),p._updateDataForRenderers(c,l,t,e,u,h,n))}))))},t.prototype._updateDataForRenderers=function(t,e,i,n,a,l,_){var f,y,v,g,w,x,T,m,b,R,L,P,C,M,E,B,O,S,k,A,j,D,I,H,V,N,z,U={},G={},W={},X={},Y=i.height(),F=e.percentWidth.value(),q=e.showValues.value(),K=e.location.value(),J=e.direction.value(),$=this._rendererData.histsByLineWidth,Q=this._rendererData.histsBySession,Z={};if(Q[_]=Z,!(t.length<=0)&&(f=o(t,i,this._study),a[t[0].firstBarTime]!==p.REMOVE_INDEX_MAGIC_NUMBER&&a[t[0].lastBarTime]!==p.REMOVE_INDEX_MAGIC_NUMBER)){for(y=Math.abs(n.indexToCoordinate(a[t[0].firstBarTime])-n.indexToCoordinate(a[t[0].lastBarTime])),v=d(t[0].rate),g=Math.max(F*y/100-v,0),w=null,x=0;x<t.length;x++){if(T=t[x],m=s(T,i,n,a,K,J,f,this._study),b=m.xBasePoint,R=m.sign,L=m.fontSize,P=m.textHAligh,C=m.y1,M=m.y2,q)for(E=0;E<v;E++)U[E]=(U[E]||0)+T.rate[E];if(!(C>Y||M<0)){if(w=w||Math.round(L),q&&w>=7.5){for(B={},O=this._study.formatter(),B.text="",S=0;S<v;S++)B.text=r(B.text,O.format(T.rate[S]),J),S!==v-1&&(B.text=r(B.text,"x",J));B.color=e.valuesColor.value(),B.font="arial",B.fontsize=w,B.horzAlign=P,B.vertAlign="middle",k=new u.Point(b+3*R,M-.61*(M-C)),B.points=[k],B.offsetX=0,B.offsetY=0,B.forceTextAlign=!0,this._textData.push(B)}for(E=0;E<v;E++)A={x1:0,y1:0,x2:0,y2:0},A.y1=C,A.y2=M,A.x1=0===E?b:b+R*(g*T.rate[E-1]/l),A.x2=A.x1+R*(g*T.rate[E]/l),Math.abs(A.y1-G[E])<1?(W[E]?W[E].push(A.x1):W[E]=[A.x1],X[E]?X[E].push(A.x2):X[E]=[A.x2]):((W[E]||X[E])&&(W[E].push(A.x1),X[E].push(A.x2),A.x1=Math.max.apply(null,W[E]),A.x2=Math.max.apply(null,X[E]),delete W[E],delete X[E]),G[E]=A.y1,Math.abs(A.x2-A.x1)<.5||(j=T.va?this._colors.vaBars[E]:this._colors.histBars[E],D=Math.round(A.y2-A.y1),$[D]||($[D]={}),I=$[D],I[j]?I[j].push(A):I[j]=[A],Z[x]?Z[x].x2<A.x2&&(Z[x].x2=A.x2):Z[x]={x1:b,x2:A.x2,y1:A.y1,y2:A.y2}))}}if(q&&null!==w&&w>=7.5){for(H=s(t[0],i,n,a,K,J,f,this._study),b=H.xBasePoint,R=H.sign,P=H.textHAligh,C=H.y1,M=H.y2,O=this._study.formatter(),V=b+3*R,N=M+.39*(M-C),z={text:"",color:Object(c.shiftColor)(e.valuesColor.value(),1.5),font:"arial",fontsize:w,horzAlign:P,vertAlign:"middle",points:[new u.Point(V,N)],offsetX:0,offsetY:0,forceTextAlign:!0},S=0;S<v;S++)z.text=r(Object(h.ensureDefined)(z.text),O.format(U[S]),J),S!==v-1&&(z.text=r(z.text,"x",J));this._textData.push(z)}}},t}()},1205:function(t,e,i){"use strict";var n,a,r,o,s,l,d,h;Object.defineProperty(e,"__esModule",{value:!0}),i.d(e,"HorizLinePaneView",function(){return h}),n=i(5),i.n(n),a=i(14),i.n(a),r=i(33),o=i(21),s=i(92),l=i(155),d=i(345),i.n(d),h=function(){function t(t,e){this._data=[],this._invalidated=!0,this._study=t,this._model=e}return t.prototype.update=function(){this._invalidated=!0},t.prototype.renderer=function(){var t,e,i,n,a;for(this._invalidated&&(this._updateViewInternal(),this._invalidated=!1),
t=new s.CompositeRenderer,e=0,i=this._data;e<i.length;e++)n=i[e],a=new d.TrendLineRenderer,a.setData(n),a.setHitTest(new o.HitTestResult(o.HitTestResult.REGULAR)),t.append(a);return t},t.prototype._updateViewInternal=function(){var t,e,i,o,s,d,h,u=this;this._data=[],t=this._study.priceScale(),e=this._model.timeScale(),!t||t.isEmpty()||e.isEmpty()||(i=this._study.graphics().horizlines(),0!==i.size&&null!==(o=this._model.timeScale().visibleBars())&&null!=(s=this._study.firstValue())&&(d=o.firstBar(),h=o.lastBar(),i.forEach(function(i,o){var c,p,_,f,y,v,g,w,x,T,m,b,R,L,P=u._study.properties().graphics.horizlines[o];if(P.visible.value())for(c=0,p=i;c<p.length;c++)for(_=p[c],f=_.indexes,y=0,v=_.items;y<v.length;y++)g=v[y],w=f[g.startIndex],x=f[g.endIndex],w===r.REMOVE_INDEX_MAGIC_NUMBER||x===r.REMOVE_INDEX_MAGIC_NUMBER||!g.extendRight&&Math.max(w,x)<d||!g.extendLeft&&Math.min(w,x)>h||(T=e.indexToCoordinate(w),m=e.indexToCoordinate(x),b=t.priceToCoordinate(Object(n.ensureDefined)(g.level),s),R=new a.Point(T,b),L=new a.Point(m,b),u._data.push({points:[R,L],extendleft:g.extendLeft,extendright:g.extendRight,leftend:l.LineEnd.Normal,rightend:l.LineEnd.Normal,width:e.width(),height:t.height(),color:P.color.value(),linewidth:P.width.value(),linestyle:P.style.value()}))})))},t}()},1206:function(t,e,i){"use strict";var n,a,r,o,s,l,d,h;Object.defineProperty(e,"__esModule",{value:!0}),i.d(e,"LinePaneView",function(){return h}),n=i(5),i.n(n),a=i(14),i.n(a),r=i(33),o=i(21),s=i(92),l=i(155),d=i(345),i.n(d),h=function(){function t(t,e){this._data=[],this._invalidated=!0,this._study=t,this._model=e}return t.prototype.update=function(){this._invalidated=!0},t.prototype.renderer=function(){var t,e,i,n,a;for(this._invalidated&&(this._updateViewInternal(),this._invalidated=!1),t=new s.CompositeRenderer,e=0,i=this._data;e<i.length;e++)n=i[e],a=new d.TrendLineRenderer,a.setData(n),a.setHitTest(new o.HitTestResult(o.HitTestResult.REGULAR)),t.append(a);return t},t.prototype._updateViewInternal=function(){var t,e,i,o,s,d,h,u=this;this._data=[],t=this._study.priceScale(),e=this._model.timeScale(),!t||t.isEmpty()||e.isEmpty()||(i=this._study.graphics().lines(),0!==i.size&&null!==(o=this._model.timeScale().visibleBars())&&null!=(s=this._study.firstValue())&&(d=o.firstBar(),h=o.lastBar(),i.forEach(function(i,o){var c,p,_,f,y,v,g,w,x,T,m,b,R,L,P,C,M,E=u._study.properties().graphics.lines[o];if(E.visible.value())for(c=0,p=i;c<p.length;c++)for(_=p[c],f=_.indexes,y=0,v=_.items;y<v.length;y++)g=v[y],w=f[g.startIndex],x=f[g.endIndex],w!==r.REMOVE_INDEX_MAGIC_NUMBER&&x!==r.REMOVE_INDEX_MAGIC_NUMBER&&(T=w+(g.startOffset||0),m=x+(g.endOffset||0),Math.max(T,m)<d||Math.min(T,m)>h||(b=e.indexToCoordinate(T),R=e.indexToCoordinate(m),L=t.priceToCoordinate(Object(n.ensureDefined)(g.startPrice),s),P=t.priceToCoordinate(Object(n.ensureDefined)(g.endPrice),s),C=new a.Point(b,L),M=new a.Point(R,P),u._data.push({points:[C,M],extendleft:!1,extendright:!1,leftend:l.LineEnd.Normal,rightend:l.LineEnd.Normal,width:e.width(),height:t.height(),color:E.color.value(),
linewidth:E.width.value(),linestyle:E.style.value()})))})))},t}()},1207:function(t,e,i){"use strict";function n(t){if("up"===t)return 1;if("down"===t)return-1;throw Error(t+" is not supported by TriangleTextMarkRenderer")}var a,r,o,s,l,d,h,u,c,p,_,f,y,v,g,w,x;Object.defineProperty(e,"__esModule",{value:!0}),a=i(1),r=i(5),o=i(14),s=i(33),l=i(479),function(t){t.Triangle="triangle",t.Rectangle="rectangle"}(d||(d={})),function(t){t.Verdana="Verdana",t.CourierNew="Courier New",t.TimesNewRoman="Times New Roman",t.Arial="Arial"}(h||(h={})),u=i(92),c=i(143),p=i(21),_=i(122),f=function(){function t(t,e){this._data=t,this._textCache=e}return t.prototype.draw=function(t){var e,i,a,r,o,s,l,d;this._data&&(e=n(this._data.direction),i=this._data.point.x,"left"===this._data.halign?i-=this._data.size:"right"===this._data.halign&&(i+=this._data.size),a=this._data.point.y,t.font=this._fontStyle(),r=t.measureText(this._data.text).width,this._textCache.textWidth=r,o=this._data.fontSize,s=Object(_.calcTextHorizontalShift)(t,r),l=.65*o,d=1*o,t.save(),t.translate(i+.5,a+.5),t.beginPath(),t.moveTo(0,0),t.lineTo(l,d*e),t.lineTo(.5*r+l,d*e),t.lineTo(.5*r+l,(d+1.75*o)*e),t.lineTo(.5*-r-l,(d+1.75*o)*e),t.lineTo(.5*-r-l,d*e),t.lineTo(-l,d*e),t.lineTo(0,0),t.strokeStyle=this._data.borderColor,t.stroke(),t.fillStyle=this._data.color,t.fill(),t.fillStyle=this._data.fontColor,t.fillText(this._data.text,.5*-r+s,e<0?e*d-.5*o:d+1.25*o),t.restore())},t.prototype.hitTest=function(t){var e,i,a,r,s,l,d,h,u=this._textCache.textWidth||0,_=this._data.fontSize,f=n(this._data.direction),y=.65*_,v=1*_,g=this._data.point.x;return"left"===this._data.halign?g-=this._data.size:"right"===this._data.halign&&(g+=this._data.size),e=this._data.point.y,i=g-.5*u-y,a=g+.5*u+y,r=e+v*f,s=e+(v+1.75*_)*f,s<r&&(l=r,r=s,s=l),Object(c.pointInRectangle)(t,new o.Point(i,r),new o.Point(a,s))?new p.HitTestResult(p.HitTestResult.REGULAR):(d=[new o.Point(this._data.point.x,this._data.point.y),new o.Point(this._data.point.x+.65*_,this._data.point.y+_*f),new o.Point(this._data.point.x-.65*_,this._data.point.y+_*f)],h=(t.x-d[0].x)*(d[1].y-d[0].y)-(t.y-d[0].y)*(d[1].x-d[0].x),((t.x-d[1].x)*(d[2].y-d[1].y)-(t.y-d[1].y)*(d[2].x-d[1].x))*h>0&&((t.x-d[2].x)*(d[0].y-d[2].y)-(t.y-d[2].y)*(d[0].x-d[2].x))*h>0?new p.HitTestResult(p.HitTestResult.REGULAR):null)},t.prototype._fontStyle=function(){return(this._data.bold?"bold ":"")+(this._data.italic?"italic ":"")+this._data.fontSize+"px "+this._data.font},t}(),y=function(){function t(t,e){this._data=t,this._textCache=e}return t.prototype.draw=function(t){var e,i=this._data.point.x,n=this._data.point.y;switch(t.font=this._fontStyle(),e=t.measureText(this._data.text).width,this._textCache.textWidth=e,t.save(),t.translate(i+.5,n+.5),t.beginPath(),t.moveTo(0,0),t.textAlign=this._data.halign,this._data.valign){case"middle":t.textBaseline="middle";break;case"top":t.textBaseline="bottom";break;case"bottom":t.textBaseline="hanging"}t.fillStyle=this._data.fontColor,t.fillText(this._data.text,0,0),t.restore()},t.prototype.hitTest=function(t){
var e,i,n=this._data.point.x+.5,a=this._data.point.y+.5,r=this._textCache.textWidth||0,s=this._data.fontSize;switch(this._data.halign){case"right":n-=r;break;case"center":n-=r/2}switch(this._data.valign){case"middle":a-=s/2;break;case"bottom":a-=s}return e=new o.Point(n,a),i=new o.Point(n+r,a+s),Object(c.pointInRectangle)(t,e,i)?new p.HitTestResult(p.HitTestResult.REGULAR):null},t.prototype._fontStyle=function(){return(this._data.bold?"bold ":"")+(this._data.italic?"italic ":"")+this._data.fontSize+"px "+this._data.font},t}(),v=i(2367),g=i.n(v),w=i(96),i.d(e,"TextMarkPaneView",function(){return x}),x=function(t){function e(e,i){var n=t.call(this)||this;return n._data=[],n._textCache=[],n._invalidated=!0,n._study=e,n._model=i,n._data=[],n._textCache=[],n}return a.__extends(e,t),e.prototype.update=function(){this._invalidated=!0},e.prototype.renderer=function(){var t,e,i,n;for(this._invalidated&&(this._updateViewInternal(),this._invalidated=!1),t=new u.CompositeRenderer,e=0;e<this._data.length;e++)switch(i=this._data[e],n=this._textCache[e],i.shape){case"triangle":t.append(new f(i,n));break;case"rectangle":t.append(new y(i,n))}return t},e.prototype._updateViewInternal=function(){var t,e,i,n,r,l,h,u=this;this._data=[],t=this._study.priceScale(),e=this._model.timeScale(),!t||t.isEmpty()||e.isEmpty()||(i=this._study.graphics().textmarks(),0!==i.size&&null!==(n=this._model.timeScale().visibleBars())&&null!=(r=this._study.firstValue())&&(l=n.firstBar(),h=n.lastBar(),i.forEach(function(i,n){var c,p,_,f,y,v,g,x,T,m,b,R,L,P,C,M,E,B=u._study.properties().graphics.textmarks[n];if(B.visible.value())for(c=0,p=i;c<p.length;c++)for(_=p[c],f=_.indexes,y=0,v=_.items;y<v.length;y++)if(g=v[y],!((x=f[g.time])===s.REMOVE_INDEX_MAGIC_NUMBER||x<l||h<x)&&null!==u._study.series().bars().valueAt(x)){switch(x=f[g.time]+(g.offset||0),T={text:g.text?g.text:"",bold:B.fontBold.value(),italic:B.fontItalic.value(),font:B.fontFamily.value(),fontColor:Object(w.generateColor)(B.fontColor.value(),B.transparency.value()),fontSize:B.fontSize.value()},m=B.location.value(),b=B.shape.value(),R=50,b){case d.Triangle:L=u._calcCoordsForTriangleShape(m,x,R,g.price,r,t,e),P=L.x,C=L.y,M=L.direction,u._data.push(a.__assign({shape:b,color:Object(w.generateColor)(B.color.value(),B.transparency.value()),borderColor:"rgb(0, 0, 0)",direction:M,point:new o.Point(P,C),halign:B.halign.value(),size:.5*e.barSpacing()},T));break;case d.Rectangle:E=u._calcCoordsForRectangleShape(m,x,g.price,r,t,e),P=E.x,C=E.y,u._data.push(a.__assign({shape:b,point:new o.Point(P,C),halign:B.halign.value(),valign:void 0!==B.valign?B.valign.value():"middle"},T))}u._textCache.push({})}})))},e.prototype._calcCoordsForTriangleShape=function(t,e,i,n,a,o,s){var d=Math.round(s.indexToCoordinate(e));switch(t){case l.MarkLocation.Top:return{x:d,y:o.height()-i,direction:"down"};case l.MarkLocation.Bottom:return{x:d,y:i,direction:"up"};case l.MarkLocation.AbsoluteDown:return{x:d,y:o.priceToCoordinate(Object(r.ensureDefined)(n),a),direction:"down"};case l.MarkLocation.AbsoluteUp:return{x:d,
y:o.priceToCoordinate(Object(r.ensureDefined)(n),a),direction:"up"};case l.MarkLocation.AboveBar:return{x:d,y:this._locationToY(t,e),direction:"down"};case l.MarkLocation.BelowBar:default:return{x:d,y:this._locationToY(t,e),direction:"up"}}},e.prototype._calcCoordsForRectangleShape=function(t,e,i,n,a,o){var s=Math.round(o.indexToCoordinate(e));switch(t){case l.MarkLocation.AbsoluteDown:case l.MarkLocation.AbsoluteUp:case l.MarkLocation.Absolute:return{x:s,y:a.priceToCoordinate(Object(r.ensureDefined)(i),n)};case l.MarkLocation.AboveBar:case l.MarkLocation.BelowBar:return{x:s,y:this._locationToY(t,e)};case l.MarkLocation.Right:case l.MarkLocation.Left:return{x:o.width(),y:a.priceToCoordinate(Object(r.ensureDefined)(i),n)};default:return{x:s,y:this._locationToY(t,e)}}},e}(g.a)},1270:function(t,e,i){"use strict";function n(t,e){a.call(this,t,e),this._calc=null,this._lines=[],this._pearsons=null,this._pearsonsLabelRenderer=new s({})}var a=i(469).LineSourcePaneView,r=i(2681).LinearRegressionPaneView,o=i(1948).ParallelChannelRenderer,s=i(410).TextRenderer,l=i(345).TrendLineRenderer,d=i(195).SelectionRenderer,h=i(21).HitTestResult,u=i(92).CompositeRenderer,c=i(96);inherit(n,a),n.prototype.getTransparencyResetLines=function(){return this._lines.map(function(t){var e=$.extend({},t);return e.color=c.resetTransparency(e.color),e})},n.prototype.renderer=function(){var t,e,i,n,a,r,s,p,_;for(this._invalidated&&(this._updateImpl(),this._invalidated=!1),t=new u,e=[],i=[this._lines[1],this._lines[0],this._lines[2]],n=[],a=0;a<i.length;a++)i[a]&&n.push(i[a]);for(a=1;a<n.length;a++)r={},r.points=[i[a].floatPoints[0],i[a].floatPoints[1],i[a-1].floatPoints[0],i[a-1].floatPoints[1]],r.color=i[a].color,r.width=this._model.timeScale().width(),r.height=this._source.priceScale().height(),r.linewidth=i[a].linewidth,r.linestyle=i[a].linestyle,r.extendleft=!1,r.extendright=i[a].extendright,r.backcolor=r.color,r.transparency=this._source.properties().styles.transparency.value(),r.skipLines=!0,r.fillBackground=!0,s=new o(new h(h.REGULAR)),s.setData(r),t.append(s);for(p=this.getTransparencyResetLines(),a=0;a<n.length;a++)s=new l,s.setData(p[a]),s.setHitTest(new h(h.REGULAR)),t.append(s),0!==a&&(e=e.concat(this._lines[a].floatPoints));return this._pearsons&&(this._pearsons.color=c.resetTransparency(this._pearsons.color),this._pearsonsLabelRenderer.setData(this._pearsons),t.append(this._pearsonsLabelRenderer)),this.isAnchorsRequired()&&this._lines&&this._lines.length>=1&&(t.append(new d({points:e})),_=this._lines[0].floatPoints,_[0].data=0,_[1].data=1,t.append(this.createLineAnchor({points:_}))),t},n.prototype._updateImpl=function(){a.prototype._updateImpl.call(this),r.prototype._updateImpl.call(this)},e.RegressionTrendPaneView=n},1925:function(t,e,i){"use strict";var n,a,r,o,s,l,d,h,u;Object.defineProperty(e,"__esModule",{value:!0}),i.d(e,"PolygonRenderer",function(){return u}),n=i(143),i.n(n),a=i(113),i.n(a),r=i(94),i.n(r),o=i(20),i.n(o),s=i(345),i.n(s),l=i(155),d=i(21),h=i(96),u=function(){function t(t){this._data=null,
this._backHittest=new d.HitTestResult(d.HitTestResult.MOVEPOINT_BACKGROUND),this._points=[],this._hittest=t||new d.HitTestResult(d.HitTestResult.MOVEPOINT)}return t.prototype.setData=function(t){this._data=t,this._points=t.points},t.prototype.draw=function(t){var e,i,n,a;if(null!==this._data&&0!==this._points.length){for(t.beginPath(),t.lineCap="butt",t.strokeStyle=this._data.color,t.lineWidth=this._data.linewidth,Object(r.setLineStyle)(t,this._data.linestyle),e=this._points[0],t.moveTo(e.x,e.y),i=0,n=this._points;i<n.length;i++)a=n[i],t.lineTo(a.x,a.y);this._data.filled&&this._data.fillBackground&&(t.fillStyle=Object(h.generateColor)(this._data.backcolor,this._data.transparency),t.fill()),this._data.filled&&!this._data.skipClosePath&&t.closePath(),this._data.linewidth>0&&t.stroke(),this._points.length>1&&(this._data.leftend===l.LineEnd.Arrow&&s.TrendLineRenderer.prototype.drawArrow(this._points[1],this._points[0],t,t.lineWidth),this._data.rightend===l.LineEnd.Arrow&&s.TrendLineRenderer.prototype.drawArrow(this._points[this._points.length-2],this._points[this._points.length-1],t,t.lineWidth))}},t.prototype.hitTest=function(t){var e,i,r,s,l;if(null===this._data||void 0!==this._data.mouseTouchable&&!this._data.mouseTouchable)return null;for(e=o.CheckMobile.any()?24:3,i=1;i<this._points.length;i++)if(r=this._points[i-1],s=this._points[i],l=Object(a.distanceToSegment)(r,s,t),l.distance<=e)return this._hittest;return this._data.filled&&this._data.fillBackground&&this._points.length>0&&(r=this._points[0],s=this._points[this._points.length-1],l=Object(a.distanceToSegment)(r,s,t),l.distance<=e)?this._hittest:this._data.filled&&this._data.fillBackground&&Object(n.pointInPolygon)(t,this._data.points)?this._backHittest:null},t}()},1948:function(t,e,i){"use strict";function n(t,e,i,n){return null!==t?Object(s.intersectPolygonAndHalfplane)(t,Object(r.halfplaneThroughPoint)(Object(r.lineThroughPoints)(e,i),n)):null}var a,r,o,s,l,d,h,u,c;Object.defineProperty(e,"__esModule",{value:!0}),i.d(e,"ParallelChannelRenderer",function(){return c}),a=i(5),i.n(a),r=i(14),i.n(r),o=i(113),i.n(o),s=i(376),i.n(s),l=i(94),i.n(l),d=i(21),h=i(93),u=i(96),c=function(){function t(t,e){this._data=null,this._hittestResult=t||new d.HitTestResult(d.HitTestResult.MOVEPOINT),this._backHittestResult=e||new d.HitTestResult(d.HitTestResult.MOVEPOINT_BACKGROUND)}return t.prototype.setData=function(t){this._data=t},t.prototype.draw=function(t){var e,i,n,a,r,o,s,d;null===this._data||this._data.points.length<2||(t.lineCap="butt",t.strokeStyle=this._data.color,t.lineWidth=this._data.linewidth,Object(l.setLineStyle)(t,this._data.linestyle),e=this._data.points,i=e[0],n=e[1],this._data.skipLines||this._extendAndDrawLineSegment(t,i,n),4===this._data.points.length&&(a=this._data.points,r=a[2],o=a[3],this._data.skipLines||this._data.skipTopLine||this._extendAndDrawLineSegment(t,r,o),this._data.fillBackground&&this._drawBackground(t,this._data.points),this._data.showMidline&&!this._data.skipLines&&(t.strokeStyle=this._data.midcolor,t.lineWidth=this._data.midlinewidth,
Object(l.setLineStyle)(t,this._data.midlinestyle),s=i.add(r).scaled(.5),d=n.add(o).scaled(.5),this._extendAndDrawLineSegment(t,s,d))))},t.prototype.hitTest=function(t){var e,i,n,a,r,o,s,l,d,h,u;if(null===this._data||this._data.points.length<2)return null;if(e=this._data.points,i=e[0],n=e[1],null!==(a=this._extendAndHitTestLineSegment(t,i,n)))return a;if(4===this._data.points.length&&!this._data.skipTopLine){if(r=this._data.points,o=r[2],s=r[3],null!==(l=this._extendAndHitTestLineSegment(t,o,s)))return l;if(this._data.showMidline&&!this._data.skipLines&&(d=i.add(o).scaled(.5),h=n.add(s).scaled(.5),null!==(u=this._extendAndHitTestLineSegment(t,d,h))))return u}return this._data.hittestOnBackground&&this._data.fillBackground?this._hitTestBackground(t):null},t.prototype._getColor=function(){var t=Object(a.ensureNotNull)(this._data);return Object(u.generateColor)(t.backcolor,t.transparency)},t.prototype._extendAndDrawLineSegment=function(t,e,i){var n=this._extendAndClipLineSegment(e,i);null!==n&&Object(l.drawLine)(t,n[0].x,n[0].y,n[1].x,n[1].y)},t.prototype._extendAndHitTestLineSegment=function(t,e,i){var n,a=this._extendAndClipLineSegment(e,i);return null!==a&&(n=Object(o.distanceToSegment)(a[0],a[1],t),n.distance<=3)?this._hittestResult:null},t.prototype._extendAndClipLineSegment=function(t,e){var i=Object(a.ensureNotNull)(this._data);return Object(h.extendAndClipLineSegment)(t,e,i.width,i.height,i.extendleft,i.extendright)},t.prototype._drawBackground=function(t,e){var i,s,l,d=Object(a.ensureNotNull)(this._data),h=e[0],u=e[1],c=e[2],p=e[3];if(!(Object(r.equalPoints)(h,u)||Object(r.equalPoints)(c,p)||Object(o.distanceToLine)(h,u,c).distance<1e-6||Object(o.distanceToLine)(h,u,p).distance<1e-6||d.width<=0||d.height<=0||(i=[new r.Point(0,0),new r.Point(d.width,0),new r.Point(d.width,d.height),new r.Point(0,d.height)],s=i,s=n(s,h,u,p),d.extendright||(s=n(s,u,p,c)),s=n(s,p,c,h),d.extendleft||(s=n(s,c,h,u)),null===s))){for(t.beginPath(),t.moveTo(s[0].x,s[0].y),l=1;l<s.length;l++)t.lineTo(s[l].x,s[l].y);t.fillStyle=this._getColor(),t.fill()}},t.prototype._hitTestBackground=function(t){var e,i,n,r,o,s,l,d,h,u,c,p=Object(a.ensureNotNull)(this._data);return 4!==p.points.length?null:(e=p.points,i=e[0],n=e[1],r=e[2],o=(n.y-i.y)/(n.x-i.x),s=i.y+o*(t.x-i.x),l=r.y+o*(t.x-r.x),d=Math.max(s,l),h=Math.min(s,l),u=Math.min(i.x,n.x),c=Math.max(i.x,n.x),!p.extendleft&&t.x<u?null:!p.extendright&&t.x>c?null:t.y>=h&&t.y<=d?this._backHittestResult:null)},t}()},2116:function(t,e,i){"use strict";var n,a;i.d(e,"a",function(){return n}),i.d(e,"b",function(){return a}),function(t){t.LeftToRight="left_to_right",t.RightToLeft="right_to_left"}(n||(n={})),function(t){t.Relative="relative",t.Absolute="absolute"}(a||(a={}))},2367:function(t,e,i){"use strict";function n(){}var a=i(37),r=a.min,o=a.max,s=i(479).MarkLocation;n.prototype._locationToY=function(t,e,i){var n,a,l,d,h,u,c;switch(i||(i=0),n=[],a=this._study.priceScale(),t){case s.AboveBar:l=TradingView.HIGH_PLOT;break;case s.BelowBar:l=TradingView.LOW_PLOT}for(d=this._study.firstValue(),i>=1&&(i-=1),
h=-i;h<=i;h++)null!==(u=this._study.series().bars().valueAt(e+h))&&(c=u[l],n.push(a.priceToCoordinate(c,d)));switch(t){case s.AboveBar:return r(n)-15;case s.BelowBar:return o(n)+15}},t.exports=n},2681:function(t,e,i){"use strict";function n(t){return t.map(function(t){var e=a.__assign({},t);return e.color=Object(l.resetTransparency)(e.color),e})}var a,r,o,s,l,d,h,u,c,p,_;Object.defineProperty(e,"__esModule",{value:!0}),i.d(e,"LinearRegressionPaneView",function(){return _}),a=i(1),r=i(5),i.n(r),o=i(14),i.n(o),s=i(21),l=i(96),d=i(92),h=i(1948),u=i(345),i.n(u),c=i(410),i.n(c),p=i(155),_=function(){function t(t,e){this._invalidated=!0,this._lines=[],this._pearsonsTextRenderer=new c.TextRenderer({}),this._pearsons=null,this._model=t,this._source=e}return t.prototype.update=function(){this._invalidated=!0},t.prototype.renderer=function(){var t,e,i,a,o,c,p,_,f,y,v,g;for(this._invalidated&&(this._updateImpl(),this._invalidated=!1),t=new d.CompositeRenderer,e=[this._lines[1],this._lines[0],this._lines[2]],i=[],a=0,o=e;a<o.length;a++)(c=o[a])&&i.push(c);for(p=1;p<i.length;p++)_={points:[e[p].floatPoints[0],e[p].floatPoints[1],e[p-1].floatPoints[0],e[p-1].floatPoints[1]],color:e[p].color,width:this._model.timeScale().width(),height:Object(r.ensureNotNull)(this._source.priceScale()).height(),linewidth:e[p].linewidth,linestyle:e[p].linestyle,extendleft:!1,extendright:e[p].extendright,backcolor:e[p].color,transparency:this._source.properties().styles.transparency.value(),skipLines:!0,fillBackground:!0,showMidline:!1},f=new h.ParallelChannelRenderer(new s.HitTestResult(s.HitTestResult.REGULAR),new s.HitTestResult(s.HitTestResult.REGULAR)),f.setData(_),t.append(f);for(y=0,v=n(this._lines);y<v.length;y++)g=v[y],f=new u.TrendLineRenderer,f.setData(g),f.setHitTest(new s.HitTestResult(s.HitTestResult.REGULAR)),t.append(f);return this._pearsons&&(this._pearsons.color=Object(l.resetTransparency)(this._pearsons.color),this._pearsonsTextRenderer.setData(this._pearsons),t.append(this._pearsonsTextRenderer)),t},t.prototype._updateImpl=function(){var t,e,i,n,a,s,l,d,h,u,c,_,f,y,v,g,w,x,T,m,b,R,L,P,C,M;if(this._lines=[],this._pearsons=null,this._source.properties().visible.value()&&(t=this._model.timeScale(),e=this._source.priceScale(),i=this._model.mainSeries(),n=i.firstBar(),e&&!e.isEmpty()&&!t.isEmpty()&&n&&(a=this._source.startIndex(),s=this._source.endIndex(),null!==a&&null!==s))){for(l=[this._source.baseLine(),this._source.downLine(),this._source.upLine()],d=Math.round(t.indexToCoordinate(a)),h=Math.round(t.indexToCoordinate(s)),u=this._source.properties(),c=[u.styles.baseLine,u.styles.downLine,u.styles.upLine],_=n[TradingView.CLOSE_PLOT],f=0;f<l.length;f++)c[f].visible.value()&&(y=Object(r.ensureNotNull)(l[f]).startPrice,v=Object(r.ensureNotNull)(l[f]).endPrice,void 0!==y&&void 0!==v&&(g=e.priceToCoordinate(y,_,!0),w=e.priceToCoordinate(v,_,!0),x=new o.Point(d,g),T=new o.Point(h,w),m=c[f].color.value(),b=c[f].linewidth.value(),R=c[f].linestyle.value(),L={floatPoints:[x,T],width:this._model.timeScale().width(),
height:Object(r.ensureNotNull)(this._source.priceScale()).height(),color:m,linewidth:b,linestyle:R,extendleft:!1,extendright:u.styles.extendLines.value(),leftend:p.LineEnd.Normal,rightend:p.LineEnd.Normal},this._lines.push(L)));P=Object(r.ensureNotNull)(this._source.downLine()),u.styles.showPearsons.value()&&void 0!==P.startPrice&&(C=e.priceToCoordinate(P.startPrice,_),M=new o.Point(d,C),this._pearsons={points:[M],text:""+this._source.pearsons(),color:u.styles.downLine.color.value(),vertAlign:"top",horzAlign:"center",font:"Arial",offsetX:0,offsetY:4,fontsize:12})}},t}()},2907:function(t,e,i){"use strict";var n,a,r,o,s,l,d,h;Object.defineProperty(e,"__esModule",{value:!0}),i.d(e,"VertLinePaneView",function(){return h}),n=i(5),i.n(n),a=i(14),i.n(a),r=i(33),o=i(21),s=i(92),l=i(155),d=i(345),i.n(d),h=function(){function t(t,e){this._data=[],this._invalidated=!0,this._study=t,this._model=e}return t.prototype.update=function(){this._invalidated=!0},t.prototype.renderer=function(){var t,e,i,n,a;for(this._invalidated&&(this._updateViewInternal(),this._invalidated=!1),t=new s.CompositeRenderer,e=0,i=this._data;e<i.length;e++)n=i[e],a=new d.TrendLineRenderer,a.setData(n),a.setHitTest(new o.HitTestResult(o.HitTestResult.REGULAR)),t.append(a);return t},t.prototype._updateViewInternal=function(){var t,e,i,o,s,d,h,u=this;this._data=[],t=this._study.priceScale(),e=this._model.timeScale(),!t||t.isEmpty()||e.isEmpty()||(i=this._study.graphics().vertlines(),0!==i.size&&null!==(o=this._model.timeScale().visibleBars())&&null!=(s=this._study.firstValue())&&(d=o.firstBar(),h=o.lastBar(),i.forEach(function(i,o){var c,p,_,f,y,v,g,w,x,T,m,b,R,L=u._study.properties().graphics.vertlines[o];if(L.visible.value())for(c=0,p=i;c<p.length;c++)for(_=p[c],f=_.indexes,y=0,v=_.items;y<v.length;y++)g=v[y],(w=f[g.index])===r.REMOVE_INDEX_MAGIC_NUMBER||w<d||h<w||(x=e.indexToCoordinate(w)+1,T=g.extendBottom?t.height():t.priceToCoordinate(Object(n.ensureDefined)(g.startPrice),s),m=g.extendTop?0:t.priceToCoordinate(Object(n.ensureDefined)(g.endPrice),s),b=new a.Point(x,T),R=new a.Point(x,m),u._data.push({points:[b,R],extendleft:g.extendBottom,extendright:g.extendTop,leftend:l.LineEnd.Normal,rightend:l.LineEnd.Normal,width:e.width(),height:t.height(),color:L.color.value(),linewidth:L.width.value(),linestyle:L.style.value()}))})))},t}()},2908:function(t,e,i){"use strict";var n,a,r,o,s,l;Object.defineProperty(e,"__esModule",{value:!0}),n=i(33),a=i(92),r=i(122),o=i(96),s=function(){function t(t){this._data=t}return t.prototype.draw=function(t){},t.prototype.drawBackground=function(t){var e=this._data,i=Object(o.generateColor)(this._data.color,this._data.transparency);Object(r.clearRect)(t,e.x1,e.y1,e.x2-e.x1,e.y2-e.y1,i)},t.prototype.hitTest=function(t){return null},t}(),i.d(e,"BackgroundPaneView",function(){return l}),l=function(){function t(t,e){this._data=[],this._invalidated=!0,this._study=t,this._model=e,this._data=[]}return t.prototype.update=function(){this._invalidated=!0},t.prototype.renderer=function(){var t,e,i,n
;for(this._invalidated&&(this._updateViewInternal(),this._invalidated=!1),t=new a.CompositeRenderer,e=0,i=this._data;e<i.length;e++)n=i[e],t.append(new s(n));return t},t.prototype._hideExtendedHours=function(t){return("inSession"===t||"outOfSession"===t)&&!this._study.series().properties().extendedHours.value()},t.prototype._updateViewInternal=function(){var t,e,i,a,r,o,s=this;this._data=[],t=this._study.priceScale(),e=this._model.timeScale(),!t||t.isEmpty()||e.isEmpty()||(i=this._study.graphics().backgrounds(),0!==i.size&&null!==(a=this._model.timeScale().visibleBars())&&(r=a.firstBar(),o=a.lastBar(),i.forEach(function(i,a){var l,d,h,u,c,p,_,f,y,v,g,w,x,T=s._study.properties().graphics.backgrounds[a];if(T.visible.value()&&!s._hideExtendedHours(a))for(l=0,d=i;l<d.length;l++)for(h=d[l],u=h.indexes,c=void 0,p=void 0,_=0,f=h.items;_<f.length;_++)y=f[_],v=u[y.start],g=u[y.stop],v===n.REMOVE_INDEX_MAGIC_NUMBER||g===n.REMOVE_INDEX_MAGIC_NUMBER||g<r||o<v||(w=Math.ceil(e.indexToCoordinate(v,!0)-.5*e.barSpacing()),x=Math.ceil(e.indexToCoordinate(g,!0)+.5*e.barSpacing()),p===v-1&&(w=c||w),c=x,p=g,w<0&&x<0||w>e.width()&&x>e.width()||s._data.push({x1:w,x2:x,y1:0,y2:t.height(),color:T.color.value(),transparency:T.transparency.value()}))})))},t}()},2909:function(t,e,i){"use strict";function n(t,e){if(t===l.TopLeft||t===l.MiddleLeft||t===l.BottomLeft)return["left",4];if(t===l.TopCenter||t===l.MiddleCenter||t===l.BottomCenter)return["center",e/2];if(t===l.TopRight||t===l.MiddleRight||t===l.BottomRight)return["right",e];throw Error("Unsupported TextPos value")}function a(t,e){if(t===l.TopLeft||t===l.TopCenter||t===l.TopRight)return["bottom",e-4];if(t===l.MiddleLeft||t===l.MiddleCenter||t===l.MiddleRight)return["middle",e-2];if(t===l.BottomLeft||t===l.BottomCenter||t===l.BottomRight)return["top",e];throw Error("Unsupported TextPos value")}var r,o,s,l,d,h,u,c;Object.defineProperty(e,"__esModule",{value:!0}),r=i(5),o=i(14),s=i(21),function(t){t[t.TopLeft=0]="TopLeft",t[t.TopCenter=1]="TopCenter",t[t.TopRight=2]="TopRight",t[t.MiddleLeft=3]="MiddleLeft",t[t.MiddleCenter=4]="MiddleCenter",t[t.MiddleRight=5]="MiddleRight",t[t.BottomLeft=6]="BottomLeft",t[t.BottomCenter=7]="BottomCenter",t[t.BottomRight=8]="BottomRight"}(l||(l={})),d=i(92),h=i(350),u=i(410),i.d(e,"LevelPaneView",function(){return c}),c=function(){function t(t,e){this._data=[],this._textData=[],this._invalidated=!0,this._study=t,this._model=e}return t.prototype.update=function(){this._invalidated=!0},t.prototype.renderer=function(){var t,e,i,n,a,r,o,l;for(this._invalidated&&(this._updateViewInternal(),this._invalidated=!1),t=new d.CompositeRenderer,e=0,i=this._data;e<i.length;e++)n=i[e],a=new h.HorizontalLineRenderer,a.setData(n),t.append(a);for(r=0,o=this._textData;r<o.length;r++)l=o[r],t.append(new u.TextRenderer(l,new s.HitTestResult(s.HitTestResult.REGULAR)));return t},t.prototype._updateViewInternal=function(){this._calcHorzLinesData(),this._calcTextData()},t.prototype._calcTextData=function(){var t,e,i,s,l=this;this._textData=[],t=this._study.priceScale(),
e=this._model.timeScale(),!t||t.isEmpty()||e.isEmpty()||(i=this._study.graphics().hlines(),0!==i.size&&null!=(s=this._study.firstValue())&&i.forEach(function(i,d){var h,u,c,p,_,f,y,v,g,w,x,T,m,b,R=l._study.properties().graphics.hlines[d];if(R.enableText.value()&&R.showText.value())for(h=0,u=i;h<u.length;h++)for(c=u[h],p=0,_=c.items;p<_.length;p++)f=_[p],y=t.priceToCoordinate(Object(r.ensureDefined)(f.level),s),v=R.textPos.value(),g=n(v,e.width()),w=g[0],x=g[1],T=a(v,y),m=T[0],b=T[1],l._textData.push({points:[new o.Point(x,b)],offsetX:0,offsetY:0,text:f.text||"",color:R.color.value(),font:"arial",fontsize:R.fontSize.value(),horzAlign:w,vertAlign:m})}))},t.prototype._calcHorzLinesData=function(){var t,e,i,n,a=this;this._data=[],t=this._study.priceScale(),e=this._model.timeScale(),!t||t.isEmpty()||e.isEmpty()||(i=this._study.graphics().hlines(),0!==i.size&&null!=(n=this._study.firstValue())&&i.forEach(function(i,s){var l,d,h,u,c,p,_,f=a._study.properties().graphics.hlines[s];if(f.visible.value())for(l=0,d=i;l<d.length;l++)for(h=d[l],u=0,c=h.items;u<c.length;u++)p=c[u],_=t.priceToCoordinate(Object(r.ensureDefined)(p.level),n),a._data.push({visible:!0,points:[new o.Point(0,_)],width:e.width(),height:t.height(),color:f.color.value(),linewidth:f.width.value(),linestyle:f.style.value()})}))},t}()},2910:function(t,e,i){"use strict";var n,a,r,o,s,l,d,h,u,c,p,_,f,y,v,g,w;Object.defineProperty(e,"__esModule",{value:!0}),n=i(1),a=i(5),r=i(14),o=i(33),s=i(479),l=i(92),d=i(143),h=i(21),u=function(){function t(t){this._data=t}return t.prototype.draw=function(t){var e="down"===this._data.direction?1:"up"===this._data.direction?-1:0,i=this._data.point.x,n=this._data.point.y;t.save(),t.fillStyle=this._data.color,t.beginPath(),t.arc(i+1,n+2*this._data.size*e+.5,this._data.size,0,2*Math.PI),t.closePath(),t.fill(),t.stroke(),t.restore()},t.prototype.hitTest=function(t){var e="down"===this._data.direction?1:"up"===this._data.direction?-1:0,i=new r.Point(this._data.point.x+.5,this._data.point.y+.5+2*this._data.size*e);return Object(d.pointInCircle)(t,i,this._data.size)?new h.HitTestResult(h.HitTestResult.REGULAR):null},t}(),c=function(){function t(t){this._data=t}return t.prototype.draw=function(t){var e="down"===this._data.direction?1:"up"===this._data.direction?-1:0,i=this._data.size,n=new r.Point(this._data.point.x-i/2,this._data.point.y-i/2+e*i),a=new r.Point(this._data.point.x+i/2,this._data.point.y+i/2+e*i),o=a.subtract(n);t.beginPath(),t.fillStyle=this._data.color,t.rect(n.x,n.y,o.x,o.y),t.stroke(),t.fill()},t.prototype.hitTest=function(t){var e="down"===this._data.direction?1:"up"===this._data.direction?-1:0,i=this._data.size,n=new r.Point(this._data.point.x-i/2,this._data.point.y-i/2+e*i),a=new r.Point(this._data.point.x+i/2,this._data.point.y+i/2+e*i),o=new r.Point(Math.min(n.x,a.x),Math.min(n.y,a.y)),s=new r.Point(Math.max(n.x,a.x),Math.max(n.y,a.y));return Object(d.pointInRectangle)(t,o,s)?new h.HitTestResult(h.HitTestResult.REGULAR):null},t}(),p=function(){function t(t,e){this._data=t,this._arrowDirection=e}
return t.prototype.draw=function(t){var e,i,n,a,r,o=this._arrowDirection,s=this._data.size,l=this._data.color,d=this._data.point.x+1,h=this._data.point.y,u=1.1*s;switch(o){case"up":h-=u;break;case"down":h+=u}switch(e=s/6,i=s/4,n=s/3,a=s/2,r=.6666666*s,t.save(),t.fillStyle=l,t.beginPath(),o){case"up":t.moveTo(d,h),t.lineTo(d-a,h+r),t.lineTo(d-i,h+r),t.lineTo(d,h+n),t.lineTo(d+i,h+r),t.lineTo(d+a,h+r),t.lineTo(d,h);break;case"down":t.moveTo(d,h+s),t.lineTo(d-a,h+n),t.lineTo(d-i,h+n),t.lineTo(d,h+r),t.lineTo(d+i,h+n),t.lineTo(d+a,h+n),t.lineTo(d,h+s);break;case"right":t.moveTo(d+e,h),t.lineTo(d-e,h-i),t.lineTo(d-e,h+i),t.lineTo(d+e,h);break;case"left":t.moveTo(d-e,h),t.lineTo(d+e,h-i),t.lineTo(d+e,h+i),t.lineTo(d-e,h)}t.closePath(),t.fill(),t.stroke(),t.restore()},t.prototype.hitTest=function(t){var e=this._hitTriangle(),i=e[0],n=e[1],a=e[2];return Object(d.pointInTriangle)(t,i,n,a)?new h.HitTestResult(h.HitTestResult.REGULAR):null},t.prototype._hitTriangle=function(){var t,e,i,n,a,o=this._data.point.x,s=this._data.point.y,l=this._arrowDirection,d=this._data.size,h=1.1*d;switch(l){case"up":s-=h;break;case"down":s+=h}switch(t=d/6,e=d/4,i=d/3,n=d/2,a=.6666666*d,l){case"up":return[new r.Point(o,s),new r.Point(o+n,s+a),new r.Point(o-n,s+a)];case"down":return[new r.Point(o,s+d),new r.Point(o+n,s+i),new r.Point(o-n,s+i)];case"right":return[new r.Point(o+t,s),new r.Point(o-t,s-e),new r.Point(o-t,s+e)];case"left":return[new r.Point(o-t,s),new r.Point(o+t,s-e),new r.Point(o+t,s+e)]}},t}(),_=i(2367),f=i.n(_),y=i(96),v=i(0),i.d(e,"ShapeMarkPaneView",function(){return w}),g=Object(v.getLogger)("Chart.ShapeMarkPaneView"),w=function(t){function e(e,i){var n=t.call(this)||this;return n._data=[],n._invalidated=!0,n._study=e,n._model=i,n._data=[],n}return n.__extends(e,t),e.prototype.update=function(){this._invalidated=!0},e.prototype.renderer=function(){var t,e,i,n;for(this._invalidated&&(this._updateViewInternal(),this._invalidated=!1),t=new l.CompositeRenderer,e=0,i=this._data;e<i.length;e++)switch(n=i[e],n.shape){case"circle":t.append(new u(n));break;case"square":t.append(new c(n));break;case"arrowUp":t.append(new p(n,"up"));break;case"arrowDown":t.append(new p(n,"down"));break;case"arrowRight":t.append(new p(n,"right"));break;case"arrowLeft":t.append(new p(n,"left"))}return t},e.prototype._updateViewInternal=function(){var t,e,i,n,a,s,l,d=this;this._data=[],t=this._study.priceScale(),e=this._model.timeScale(),!t||t.isEmpty()||e.isEmpty()||(i=this._study.graphics().shapemarks(),0!==i.size&&null!==(n=this._model.timeScale().visibleBars())&&null!=(a=this._study.firstValue())&&(s=n.firstBar(),l=n.lastBar(),i.forEach(function(i,n){var h,u,c,p,_,f,v,g,w,x,T,m,b,R,L,P,C,M=d._study.properties().graphics.shapemarks[n];if(M.visible.value())for(h=0,u=i;h<u.length;h++)for(c=u[h],p=c.indexes,_=0,f=c.items;_<f.length;_++)if(v=f[_],!((g=p[v.time])===o.REMOVE_INDEX_MAGIC_NUMBER||g<s||l<g)&&null!==d._study.series().bars().valueAt(g))switch(w="left"===M.halign.value()?-(e.barSpacing()/2+1):"right"===M.halign.value()?e.barSpacing()/2+1:0,
x=M.location.value(),T=M.shape.value(),m=parseInt(M.size.value()),b=Object(y.generateColor)(M.color.value(),M.transparency.value()),R=d._calcCoordsForShape(x,g,m,v.price,a,t,e),L=R.x,P=R.y,C=R.direction,T){case"circle":case"square":d._data.push({shape:T,color:b,direction:C,point:new r.Point(L+w,P),size:m});break;case"arrowUp":case"arrowDown":case"arrowRight":case"arrowLeft":d._data.push({shape:T,color:b,point:new r.Point(L+w,P),size:m})}})))},e.prototype._calcCoordsForShape=function(t,e,i,n,r,o,l){var d=Math.round(l.indexToCoordinate(e));switch(t){case s.MarkLocation.Absolute:return{x:d,y:o.priceToCoordinate(Object(a.ensureDefined)(n),r),direction:""};case s.MarkLocation.AbsoluteDown:return{x:d,y:o.priceToCoordinate(Object(a.ensureDefined)(n),r),direction:"down"};case s.MarkLocation.AbsoluteUp:return{x:d,y:o.priceToCoordinate(Object(a.ensureDefined)(n),r),direction:"up"};case s.MarkLocation.AboveBar:return{x:d,y:this._locationToY(t,e,Math.floor(2*i/l.barSpacing())+1),direction:"up"};case s.MarkLocation.BelowBar:return{x:d,y:this._locationToY(t,e,Math.floor(2*i/l.barSpacing())+1),direction:"down"};default:return g.logWarn("Bad location value: "+t),{x:d,y:this._locationToY(s.MarkLocation.AbsoluteUp,e),direction:"up"}}},e}(f.a)},2911:function(t,e,i){"use strict";function n(t,e,i,n,a,s){var l,d,h,u;return Object(r.equalPoints)(t,e)?[t,e]:(l=new r.Point(0,0),d=new r.Point(i,n),a&&(h=t.subtract(e),u=Object(o.intersectRayAndRectangle)(t,t.add(h),l,d),u?t=u:e=new r.Point(i,e.y)),s&&(h=e.subtract(t),u=Object(o.intersectRayAndRectangle)(e,e.add(h),l,d),e=u||new r.Point(i,e.y)),[t,e])}var a,r,o,s,l,d,h,u,c;Object.defineProperty(e,"__esModule",{value:!0}),i.d(e,"TrendChannelPaneView",function(){return c}),a=i(5),i.n(a),r=i(14),i.n(r),o=i(376),i.n(o),s=i(33),l=i(21),d=i(92),h=i(115),u=i(1925),c=function(){function t(t,e){this._data=[],this._invalidated=!0,this._study=t,this._model=e,this._data=[]}return t.prototype.update=function(){this._invalidated=!0},t.prototype.renderer=function(){var t,e,i,n,a;for(this._invalidated&&(this._updateViewInternal(),this._invalidated=!1),t=new d.CompositeRenderer,e=0,i=this._data;e<i.length;e++)n=i[e],a=new u.PolygonRenderer(new l.HitTestResult(l.HitTestResult.REGULAR)),a.setData(n),t.append(a);return t},t.prototype._updateViewInternal=function(){var t,e,i,o,l,d,u,c=this;this._data=[],t=this._study.priceScale(),e=this._model.timeScale(),!t||t.isEmpty()||e.isEmpty()||(i=this._study.graphics().trendchannels(),0!==i.size&&null!==(o=this._model.timeScale().visibleBars())&&null!=(l=this._study.firstValue())&&(d=o.firstBar(),u=o.lastBar(),i.forEach(function(i,o){var p,_,f,y,v,g,w,x,T,m,b,R,L,P,C,M,E,B,O,S,k,A,j=c._study.properties().graphics.trendchannels[o];for(p=0,_=i;p<_.length;p++)for(f=_[p],y=f.indexes,v=0,g=f.items;v<g.length;v++)w=g[v],x=y[w.startIndex],T=y[w.endIndex],x===s.REMOVE_INDEX_MAGIC_NUMBER||T===s.REMOVE_INDEX_MAGIC_NUMBER||Math.max(x,T)<d&&!w.extendRight||Math.min(x,T)>u&&!w.extendLeft||(m=t.priceToCoordinate(Object(a.ensureDefined)(w.startHighPrice),l),
b=t.priceToCoordinate(Object(a.ensureDefined)(w.startLowPrice),l),R=t.priceToCoordinate(Object(a.ensureDefined)(w.endHighPrice),l),L=m-b,P=R-L,C=e.indexToCoordinate(x),M=e.indexToCoordinate(T),E=n(new r.Point(C,m),new r.Point(M,R),e.width(),t.height(),w.extendLeft,w.extendRight),B=E[0],O=E[1],S=n(new r.Point(C,b),new r.Point(M,P),e.width(),t.height(),w.extendLeft,w.extendRight),k=S[0],A=S[1],c._data.push({points:[B,k,A,O],color:j.color.value(),backcolor:j.color.value(),linewidth:void 0!==j.borderWidth?j.borderWidth.value():0,linestyle:h.LINESTYLE_SOLID,filled:!0,fillBackground:!0,transparency:w.transparency?Math.min(w.transparency+j.transparency.value(),100):j.transparency.value(),mouseTouchable:!0}))})))},t}()}});